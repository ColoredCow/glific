<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.24.1">
    <meta name="project" content="Glific v1.3.3">

    <title>Glific — Glific v1.3.3</title>
    <link rel="stylesheet" href="dist/elixir-a172fe91e725dcb259e2.css" />

    <script src="dist/sidebar_items-35501c8f01.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f27ff079945e43879c46.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="https://glific.io" class="sidebar-projectName">
Glific
      </a>
      <strong class="sidebar-projectVersion">
        v1.3.3
      </strong>
    </div>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">Pages</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
Glific <small class="app-vsn">(Glific v1.3.3)</small>

          <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>

      </h1>


        <section id="moduledoc">
<p>Glific keeps the contexts that define your domain
and business logic.</p><p>Contexts are also responsible for managing your data, regardless
if it comes from the database, an external API or others.</p><p>For now we'll keep some commonly used functions here, until we need
a new file</p>
        </section>


        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#atomize_keys/1">atomize_keys(map)</a>

  </div>

    <div class="summary-synopsis"><p>Convert map string keys to :atom keys</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#go_back_time/3">go_back_time(go_back, time \\ DateTime.utc_now(), unit \\ :hour)</a>

  </div>

    <div class="summary-synopsis"><p>Return a time object where you go back x units. We introduce the notion
of hour and minute</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#in_past_time/3">in_past_time(time, units \\ :hours, back \\ 24)</a>

  </div>

    <div class="summary-synopsis"><p>See if the current time is within the past time units</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#parse_maybe_integer/1">parse_maybe_integer(value)</a>

  </div>

    <div class="summary-synopsis"><p>Wrapper to return :ok/:error when parsing strings to potential integers</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#safe_string_to_atom/1">safe_string_to_atom(value)</a>

  </div>

    <div class="summary-synopsis"><p>You shouldn’t really use String.to_atom/1 on user-supplied data.
The BEAM has a limit on how many different atoms you can have and they’re not garbage collected!
With data coming from outside the system, stick to strings or use String.to_existing_atom/1 instead!
So this is a generic function which will convert the string to atom and throws an error in case of invalid key</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#signature/3">signature(organization_id, body, timestamp)</a>

  </div>

    <div class="summary-synopsis"><p>Compute the signature at a specific time for the body</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#stacktrace/0">stacktrace()</a>

  </div>

    <div class="summary-synopsis"><p>easy way for glific developers to get a stacktrace when debugging</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#string_clean/1">string_clean(str)</a>

  </div>

    <div class="summary-synopsis"><p>Lets get rid of all non valid characters. We are assuming any language and hence using unicode syntax
and not restricting ourselves to alphanumeric</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#suspicious_code/1">suspicious_code(code)</a>

  </div>

    <div class="summary-synopsis"><p>Really simple function to ensure folks do not add Repo and/or IO calls
to an EEx snippet. This is an extremely short term fix to avoid shooting
ourselves in the foot, but we should move to lua for flows scripting in the
near future</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#validate_shortcode/1">validate_shortcode(changeset)</a>

  </div>

    <div class="summary-synopsis"><p>Validates inputed shortcode, if shortcode is invalid it returns message that the shortcode is invalid
along with the valid shortcode.</p></div>

</div>

  </div>

        </section>


        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions
          </h1>
          <div class="functions-list">
<section class="detail" id="atomize_keys/1">

  <div class="detail-header">
    <a href="#atomize_keys/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">atomize_keys(map)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L100" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>atomize_keys(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()</pre>

      </div>

<p>Convert map string keys to :atom keys</p>
  </section>
</section>
<section class="detail" id="go_back_time/3">

    <span id="go_back_time/1"></span>

    <span id="go_back_time/2"></span>

  <div class="detail-header">
    <a href="#go_back_time/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">go_back_time(go_back, time \\ DateTime.utc_now(), unit \\ :hour)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L84" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>go_back_time(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>(), <a href="https://hexdocs.pm/elixir/DateTime.html#t:t/0">DateTime.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/DateTime.html#t:t/0">DateTime.t</a>()</pre>

      </div>

<p>Return a time object where you go back x units. We introduce the notion
of hour and minute</p>
  </section>
</section>
<section class="detail" id="in_past_time/3">

    <span id="in_past_time/1"></span>

    <span id="in_past_time/2"></span>

  <div class="detail-header">
    <a href="#in_past_time/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">in_past_time(time, units \\ :hours, back \\ 24)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L76" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>in_past_time(<a href="https://hexdocs.pm/elixir/DateTime.html#t:t/0">DateTime.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>()</pre>

      </div>

<p>See if the current time is within the past time units</p>
  </section>
</section>
<section class="detail" id="parse_maybe_integer/1">

  <div class="detail-header">
    <a href="#parse_maybe_integer/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">parse_maybe_integer(value)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L21" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>parse_maybe_integer(<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>()) :: {:ok, <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>()} | :error</pre>

      </div>

<p>Wrapper to return :ok/:error when parsing strings to potential integers</p>
  </section>
</section>
<section class="detail" id="safe_string_to_atom/1">

  <div class="detail-header">
    <a href="#safe_string_to_atom/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">safe_string_to_atom(value)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L166" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>safe_string_to_atom(<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>

<p>You shouldn’t really use String.to_atom/1 on user-supplied data.
The BEAM has a limit on how many different atoms you can have and they’re not garbage collected!
With data coming from outside the system, stick to strings or use String.to_existing_atom/1 instead!
So this is a generic function which will convert the string to atom and throws an error in case of invalid key</p>
  </section>
</section>
<section class="detail" id="signature/3">

  <div class="detail-header">
    <a href="#signature/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">signature(organization_id, body, timestamp)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L150" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>signature(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">non_neg_integer</a>(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">non_neg_integer</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>

<p>Compute the signature at a specific time for the body</p>
  </section>
</section>
<section class="detail" id="stacktrace/0">

  <div class="detail-header">
    <a href="#stacktrace/0" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">stacktrace()</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L126" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>stacktrace() :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>

<p>easy way for glific developers to get a stacktrace when debugging</p>
  </section>
</section>
<section class="detail" id="string_clean/1">

  <div class="detail-header">
    <a href="#string_clean/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">string_clean(str)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L63" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>string_clean(<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | nil) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | nil</pre>

      </div>

<p>Lets get rid of all non valid characters. We are assuming any language and hence using unicode syntax
and not restricting ourselves to alphanumeric</p>
  </section>
</section>
<section class="detail" id="suspicious_code/1">

  <div class="detail-header">
    <a href="#suspicious_code/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">suspicious_code(code)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L143" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>suspicious_code(<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>()</pre>

      </div>

<p>Really simple function to ensure folks do not add Repo and/or IO calls
to an EEx snippet. This is an extremely short term fix to avoid shooting
ourselves in the foot, but we should move to lua for flows scripting in the
near future</p><p>Note that folks can potentially find other ways to access the same modules, so
this by no means should be considered remotely secure</p>
  </section>
</section>
<section class="detail" id="validate_shortcode/1">

  <div class="detail-header">
    <a href="#validate_shortcode/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">validate_shortcode(changeset)</h1>

      <a href="https://github.com/glific/glific/blob/master/lib/glific.ex#L44" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>validate_shortcode(<a href="https://hexdocs.pm/ecto/3.5.8/Ecto.Changeset.html#t:t/0">Ecto.Changeset.t</a>()) ::
  <a href="https://hexdocs.pm/ecto/3.5.8/Ecto.Changeset.html#t:t/0">Ecto.Changeset.t</a>() | <a href="https://hexdocs.pm/ecto/3.5.8/Ecto.Changeset.html#t:t/0">Ecto.Changeset.t</a>()</pre>

      </div>

<p>Validates inputed shortcode, if shortcode is invalid it returns message that the shortcode is invalid
along with the valid shortcode.</p>
  </section>
</section>

          </div>
        </section>

      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.24.1) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
